dplyr::select(!c(Date,t2m))
View(BF_temp_trial)
#############################
### ERA5 data for Tengrela ###
#############################
BF_data <- as.data.frame(read_csv(file = "temp data/t2m_2019_BF_Tengrela.csv")) %>%
mutate(Date = as.Date(time),
time = hour(time),
Site = "Tengrela",
Hut = "ERA5",
temp = t2m -  273.5) %>%
filter(Date >= "2019-09-08" & Date <= "2019-10-19")
View(BF_data)
BF_temp_trial <- BF_data %>%
dplyr::select(!c(Date,t2m))
View(BF_temp_trial)
BF_temp_trial <- BF_data %>%
dplyr::select(!c(Date,t2m))%>%
subset(time >= 20 | time <= 6) %>%
mutate(mark_trial = c(rep(0,7),rep(1:41, each = 11), rep(42,4))) %>%
group_by(mark_trial) %>%
mutate(trial_min_temp = min(temp),
trial_max_temp = max(temp),
trial_mean_temp = mean(temp),
trial_temp_range = trial_max_temp - trial_min_temp) %>%
dplyr::select(!c(temp, time)) %>%
distinct()
View(BF_temp_trial)
seq.Date("2019-09-07", "2019-10-18")
seq.Date(2019-09-07, 2019-10-18)
seq.Date(as.Date("2019-09-07"), as.Date("2019-10-18")
)
seq.Date(as.Date("2019-09-07"), as.Date("2019-10-18"), by = "day")
BF_temp_trial <- BF_data %>%
dplyr::select(!c(Date,t2m))%>%
subset(time >= 20 | time <= 6) %>%
mutate(mark_trial = c(rep(0,7),rep(1:41, each = 11), rep(42,4))) %>%
group_by(mark_trial) %>%
mutate(trial_min_temp = min(temp),
trial_max_temp = max(temp),
trial_mean_temp = mean(temp),
trial_temp_range = trial_max_temp - trial_min_temp) %>%
dplyr::select(!c(temp, time)) %>%
distinct()%>%
mutate(Date = seq.Date(as.Date("2019-09-07"), as.Date("2019-10-19"), by = "day"))
BF_temp_trial <- BF_data %>%
dplyr::select(!c(Date,t2m))%>%
subset(time >= 20 | time <= 6) %>%
mutate(mark_trial = c(rep(0,7),rep(1:41, each = 11), rep(42,4))) %>%
group_by(mark_trial) %>%
mutate(trial_min_temp = min(temp),
trial_max_temp = max(temp),
trial_mean_temp = mean(temp),
trial_temp_range = trial_max_temp - trial_min_temp) %>%
dplyr::select(!c(temp, time)) %>%
distinct()
BF_temp_trial <- cbind(BF_temp_trial, Date)
Date = seq.Date(as.Date("2019-09-07"), as.Date("2019-10-19"), by = "day")
BF_temp_trial <- cbind(BF_temp_trial, Date)
BF_temp_trial
Date <-  seq.Date(as.Date("2019-09-07"), as.Date("2019-10-19"), by = "day")
BF_temp_trial <- cbind(BF_temp_trial, Date)
BF_temp_trial <- BF_data %>%
dplyr::select(!c(Date,t2m))%>%
subset(time >= 20 | time <= 6) %>%
mutate(mark_trial = c(rep(0,7),rep(1:41, each = 11), rep(42,4))) %>%
group_by(mark_trial) %>%
mutate(trial_min_temp = min(temp),
trial_max_temp = max(temp),
trial_mean_temp = mean(temp),
trial_temp_range = trial_max_temp - trial_min_temp) %>%
dplyr::select(!c(temp, time)) %>%
distinct()
BF_temp_trial <- cbind(BF_temp_trial, Date)
BF_temp_trial <- BF_data %>%
dplyr::select(!c(Date,t2m))%>%
subset(time >= 20 | time <= 6) %>%
mutate(mark_trial = c(rep(0,7),rep(1:41, each = 11), rep(42,4))) %>%
group_by(mark_trial) %>%
mutate(trial_min_temp = min(temp),
trial_max_temp = max(temp),
trial_mean_temp = mean(temp),
trial_temp_range = trial_max_temp - trial_min_temp) %>%
dplyr::select(!c(temp, time)) %>%
distinct()
BF_temp_trial <- cbind(Date,BF_temp_trial)
View(BF_temp_trial)
colnames(BF_temp_trial)[1] <- "Date"
BF_temp <- BF_data %>%
group_by(Date) %>%
mutate(min_temp = min(temp),
max_temp = max(temp),
mean_temp = mean(temp),
diurnal_temp_range = max_temp - min_temp) %>%
ungroup() %>%
distinct()
View(BF_temp)
BF_temp <- BF_data %>%
group_by(Date) %>%
mutate(min_temp = min(temp),
max_temp = max(temp),
mean_temp = mean(temp),
diurnal_temp_range = max_temp - min_temp) %>%
ungroup() %>%
distinct() %>%
dplyr::select(c("Date", "min_temp", "max_temp", "mean_temp" ,"diurnal_temp_range"))
BF_temp_trial <- BF_data %>%
dplyr::select(!c(Date,t2m))%>%
subset(time >= 20 | time <= 6) %>%
mutate(mark_trial = c(rep(0,7),rep(1:41, each = 11), rep(42,4))) %>%
group_by(mark_trial) %>%
mutate(trial_min_temp = min(temp),
trial_max_temp = max(temp),
trial_mean_temp = mean(temp),
trial_temp_range = trial_max_temp - trial_min_temp) %>%
dplyr::select(!c(temp, time)) %>%
distinct() %>%
dplyr::select(c("trial_min_temp", "trial_max_temp", "trial_mean_temp","trial_temp_range"))
BF_temp_trial <- cbind(Date,BF_temp_trial)
colnames(BF_temp_trial)[1] <- "Date"
BF_temp_trial <- BF_data %>%
dplyr::select(!c(Date,t2m))%>%
subset(time >= 20 | time <= 6) %>%
mutate(mark_trial = c(rep(0,7),rep(1:41, each = 11), rep(42,4))) %>%
group_by(mark_trial) %>%
mutate(trial_min_temp = min(temp),
trial_max_temp = max(temp),
trial_mean_temp = mean(temp),
trial_temp_range = trial_max_temp - trial_min_temp) %>%
dplyr::select(!c(temp, time)) %>%
distinct() %>%
ungroup() %>%
dplyr::select(c("trial_min_temp", "trial_max_temp", "trial_mean_temp","trial_temp_range"))
BF_temp_trial <- cbind(Date,BF_temp_trial)
colnames(BF_temp_trial)[1] <- "Date"
left_join(BF_temp, BF_temp_trial, by = "Date")
BF_temp <- BF_data %>%
group_by(Date) %>%
mutate(min_temp = min(temp),
max_temp = max(temp),
mean_temp = mean(temp),
diurnal_temp_range = max_temp - min_temp) %>%
ungroup() %>%
distinct() %>%
dplyr::select(c(!"temp","Date", "min_temp", "max_temp", "mean_temp" ,"diurnal_temp_range"))
BF_temp <- BF_data %>%
group_by(Date) %>%
mutate(min_temp = min(temp),
max_temp = max(temp),
mean_temp = mean(temp),
diurnal_temp_range = max_temp - min_temp) %>%
ungroup() %>%
distinct() %>%
dplyr::select(c("Date", "min_temp", "max_temp", "mean_temp" ,"diurnal_temp_range"))
BF_temp_trial <- BF_data %>%
dplyr::select(!c(Date,t2m))%>%
subset(time >= 20 | time <= 6) %>%
mutate(mark_trial = c(rep(0,7),rep(1:41, each = 11), rep(42,4))) %>%
group_by(mark_trial) %>%
mutate(trial_min_temp = min(temp),
trial_max_temp = max(temp),
trial_mean_temp = mean(temp),
trial_temp_range = trial_max_temp - trial_min_temp) %>%
dplyr::select(!c(temp, time)) %>%
distinct() %>%
ungroup() %>%
dplyr::select(c("trial_min_temp", "trial_max_temp", "trial_mean_temp","trial_temp_range"))
BF_temp_trial <- cbind(Date,BF_temp_trial)
colnames(BF_temp_trial)[1] <- "Date"
left_join(BF_temp, BF_temp_trial, by = "Date")
View(left_join(BF_temp, BF_temp_trial, by = "Date") )
BF_temp <- BF_temp   %>%
left_join(BF_temp, BF_temp_trial, by = "Date")%>%
distinct()
BF_temp_trial <- BF_data %>%
dplyr::select(!c(Date,t2m))%>%
subset(time >= 20 | time <= 6) %>%
mutate(mark_trial = c(rep(0,7),rep(1:41, each = 11), rep(42,4))) %>%
group_by(mark_trial) %>%
mutate(trial_min_temp = min(temp),
trial_max_temp = max(temp),
trial_mean_temp = mean(temp),
trial_temp_range = trial_max_temp - trial_min_temp) %>%
dplyr::select(!c(temp, time)) %>%
distinct() %>%
ungroup() %>%
dplyr::select(c("trial_min_temp", "trial_max_temp", "trial_mean_temp","trial_temp_range"))
BF_temp_trial <- cbind(Date,BF_temp_trial)
colnames(BF_temp_trial)[1] <- "Date"
View(BF_temp_trial)
BF_temp <- BF_data %>%
group_by(Date) %>%
mutate(min_temp = min(temp),
max_temp = max(temp),
mean_temp = mean(temp),
diurnal_temp_range = max_temp - min_temp) %>%
ungroup() %>%
distinct() %>%
dplyr::select(c("Date", "min_temp", "max_temp", "mean_temp" ,"diurnal_temp_range"))
BF_temp <- BF_data %>%
group_by(Date) %>%
mutate(min_temp = min(temp),
max_temp = max(temp),
mean_temp = mean(temp),
diurnal_temp_range = max_temp - min_temp) %>%
ungroup() %>%
dplyr::select(c("Date", "min_temp", "max_temp", "mean_temp" ,"diurnal_temp_range")) %>%
distinct()
BF_temp_trial <- cbind(Date,BF_temp_trial)[-1,]
BF_temp_trial <- BF_data %>%
dplyr::select(!c(Date,t2m))%>%
subset(time >= 20 | time <= 6) %>%
mutate(mark_trial = c(rep(0,7),rep(1:41, each = 11), rep(42,4))) %>%
group_by(mark_trial) %>%
mutate(trial_min_temp = min(temp),
trial_max_temp = max(temp),
trial_mean_temp = mean(temp),
trial_temp_range = trial_max_temp - trial_min_temp) %>%
dplyr::select(!c(temp, time)) %>%
distinct() %>%
ungroup() %>%
dplyr::select(c("trial_min_temp", "trial_max_temp", "trial_mean_temp","trial_temp_range"))
Date <-  seq.Date(as.Date("2019-09-07"), as.Date("2019-10-19"), by = "day")
BF_temp_trial <- cbind(Date,BF_temp_trial)[-1,]
colnames(BF_temp_trial)[1] <- "Date"
BF_temp <-  left_join(BF_temp,BF_temp_trial, by = "Date")
View(BF_temp)
####Combining temp data with trial data
n_mos <- left_join(n_mos, BF_temp, by = "Date")
View(n_mos)
n_mos <- dplyr::select(!ends_with(".x"))
n_mos <- dplyr::select(!ends_with(".x"))
n_mos <- dplyr::select(n_mos, !ends_with(".x"))
n_mos <- dplyr::select(n_mos, !ends_with(".y"))
####Combining temp data with trial data
n_mos <- left_join(n_mos, BF_temp, by = "Date")
model_5_1_diu_temp <- glmer.nb(formula = Count~Location + WashedStatus+ (1|marker) + diurnal_temp_range, data = n_mos)
summary(model_5_1_diu_temp)
model_5_1_trial_range <- glmer.nb(formula = Count~Location + WashedStatus+ (1|marker) + trial_temp_range, data = n_mos)
model_5_1_trial_range <- update(model_5_1_trial_range, control = glmerControl(optimizer = "bobyqa"))
summary(model_5_1_trial_range)
summary(model_5_1_diu_temp)
summary(model_5_1_trial_range)
model_5_1_mean_temp <- glmer.nb(formula = Count~Location + WashedStatus+ (1|marker) + mean_temp, data = n_mos)
model_5_1_mean_temp <- update(model_5_1_mean_temp, control = glmerControl(optimizer = "bobyqa"))
summary(model_5_1_mean_temp)
model_5_1_trial_temp <- glmer.nb(formula = Count~Location + WashedStatus+ (1|marker) + trial_mean_temp, data = n_mos)
model_5_1_trial_temp <- update(model_5_1_trial_temp, control = glmerControl(optimizer = "bobyqa"))
summary(model_5_1_trial_temp)
write(tidy(model_5_1_trial_range), "Best model for count.csv")
write.csv(tidy(model_5_1_trial_range), "Best model for count.csv")
####Combining temp data with trial data
mf_mos_temp <- left_join(mf_mos, BF_temp, by = "Date")
bf_num_loc_Rand_mean_temp <- glmer(Fed~Total.Loc+ Location + WashedStatus + Total.Loc * WashedStatus + (1|Hut)
+ mean_temp + (1|marker)  + (1|Sleeper), data = mf_mos_temp, family =  binomial("logit"))
bf_num_loc_Rand_mean_temp <- update(bf_num_loc_Rand_mean_temp,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=3e5)))
View(mf_mos_temp)
View(mf_mos)
a <- mf_mos
mf_mos <- mf_mos[,1:16]
View(mf_mos)
mf_mos_temp <- left_join(mf_mos, BF_temp, by = "Date")
View(mf_mos_temp)
bf_num_loc_Rand_mean_temp <- glmer(Fed~Total.Loc+ Location + WashedStatus + Total.Loc * WashedStatus + (1|Hut)
+ mean_temp + (1|marker)  + (1|Sleeper), data = mf_mos_temp, family =  binomial("logit"))
bf_num_loc_Rand_mean_temp <- update(bf_num_loc_Rand_mean_temp,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=3e5)))
summary(bf_num_loc_Rand_mean_temp)
summary(model_5_1_trial_range)
summary(model_5_1_trial_temp)
summary(bf_num_loc_Rand_mean_temp)
##############################################################
################Blood-feeding modeling########################
##############################################################
View(mf_mos_temp)
bf_num_loc_Rand_trial_temp <- glmer(Fed~Total.Loc+ Location + WashedStatus + Total.Loc * WashedStatus + (1|Hut)
+ trial_mean_temp + (1|marker)  + (1|Sleeper), data = mf_mos_temp, family =  binomial("logit"))
summary(bf_num_loc_Rand_trial_temp)
bf_num_loc_Rand_trial_temp <- glmer(Fed~Total.Loc+ Location + WashedStatus + Total.Loc * WashedStatus + (1|Hut)
+ (1|marker)  + (1|Sleeper), data = mf_mos_temp, family =  binomial("logit"))
bf_num_loc_Rand_trial_temp <- update(bf_num_loc_Rand_trial_temp,control=glmerControl(optimizer="bobyqa"))
summary(bf_num_loc_Rand_trial_temp)
bf_num_loc_Rand_trial_temp_range <- glmer(Fed~Total.Loc+ Location + WashedStatus + Total.Loc * WashedStatus + (1|Hut)
+ trial_temp_range + (1|marker)  + (1|Sleeper), data = mf_mos_temp, family =  binomial("logit"))
View(mf_mos_temp)
summary(bf_num_loc_Rand_trial_temp)
summary(bf_num_loc_Rand_trial_temp_range)
View(mf_mos)
View(distinct(mf_mos))
View(mor_fed)
mor_fed_temp <- left_join(mor_fed, BF_temp, by = "Date")
View(mor_fed_temp)
View(mf_mos)
bf_num_loc_Rand_mean_temp <- glmer(Fed~Total.Loc+ Location + WashedStatus + Total.Loc * WashedStatus + (1|Hut)
+ mean_temp + mean_temp + (1|marker)  + (1|Sleeper), data = mor_fed_temp,
family =  binomial("logit"))
bf_num_loc_Rand_mean_temp <- update(bf_num_loc_Rand_mean_temp,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=3e5)))
summary(bf_num_loc_Rand_mean_temp)
bf_num_loc_Rand_trial_temp <- glmer(Fed~Total.Loc+ Location + WashedStatus + Total.Loc * WashedStatus + (1|Hut)
+ (1|marker)  + (1|Sleeper), data = mf_mos_temp, family =  binomial("logit"))
bf_num_loc_Rand_trial_temp <- update(bf_num_loc_Rand_trial_temp,control=glmerControl(optimizer="bobyqa"))
summary(bf_num_loc_Rand_trial_temp)
bf_num_loc_Rand_trial_temp <- glmer(Fed~Total.Loc+ Location + WashedStatus + Total.Loc * WashedStatus + (1|Hut)
+ (1|marker)  + (1|Sleeper), data = mor_fed_temp, family =  binomial("logit"))
bf_num_loc_Rand_trial_temp <- update(bf_num_loc_Rand_trial_temp,control=glmerControl(optimizer="bobyqa"))
summary(bf_num_loc_Rand_trial_temp)
bf_num_loc_Rand_trial_temp <- glmer(Fed~Total.Loc+ Location + WashedStatus + Total.Loc * WashedStatus + (1|Hut)
+ trial_mean_temp+ (1|marker)  + (1|Sleeper), data = mor_fed_temp, family =  binomial("logit"))
bf_num_loc_Rand_trial_temp <- update(bf_num_loc_Rand_trial_temp,control=glmerControl(optimizer="bobyqa"))
ss <- getME(bf_num_loc_Rand_trial_temp,c("theta","fixef"))
bf_num_loc_Rand_trial_temp <- update(bf_num_loc_Rand_trial_temp,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=5e5)))
summary(bf_num_loc_Rand_trial_temp)
bf_num_loc_Rand_trial_temp_range <- glmer(Fed~Total.Loc+ Location + WashedStatus + Total.Loc * WashedStatus + (1|Hut)
+ trial_temp_range + (1|marker)  + (1|Sleeper), data = mor_fed_temp,
family =  binomial("logit"))
bf_num_loc_Rand_trial_temp_range <- update(bf_num_loc_Rand_trial_temp_range,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=3e5)))
ss <- getME(bf_num_loc_Rand_trial_temp_range,c("theta","fixef"))
bf_num_loc_Rand_trial_temp_range <- update(bf_num_loc_Rand_trial_temp_range,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=5e5)))
bf_num_loc_Rand_trial_temp_range <- glmer(Fed~Total.Loc+ Location + WashedStatus + Total.Loc * WashedStatus + (1|Hut)
+ trial_temp_range + (1|marker)  + (1|Sleeper), data = mor_fed_temp,
family =  binomial("logit"))
ss <- getME(bf_num_loc_Rand_trial_temp_range,c("theta","fixef"))
bf_num_loc_Rand_trial_temp_range <- update(bf_num_loc_Rand_trial_temp_range,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=5e5)))
summary(bf_num_loc_Rand_trial_temp_range)
bf_num_loc_Rand_temp_range <- glmer(Fed~Total.Loc+ Location + WashedStatus + Total.Loc * WashedStatus + (1|Hut)
+ diurnal_temp_range + (1|marker)  + (1|Sleeper), data = mor_fed_temp,
family =  binomial("logit"))
bf_num_loc_Rand_temp_range <- update(bf_num_loc_Rand_temp_range,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=3e5)))
bf_num_loc_Rand_temp_range <- glmer(Fed~Total.Loc+ Location + WashedStatus + Total.Loc * WashedStatus + (1|Hut)
+ diurnal_temp_range + (1|marker)  + (1|Sleeper), data = mor_fed_temp,
family =  binomial("logit"))
ss <- getME(bf_num_loc_Rand_temp_range,c("theta","fixef"))
bf_num_loc_Rand_temp_range <- update(bf_num_loc_Rand_temp_range,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=5e5)))
summary(bf_num_loc_Rand_temp_range)
mor_fed_num_ms_temp <- glmer(Dead~Fed + Location + Treatment + Location * Treatment + Total.Loc + Total.Loc*Treatment +
trial_temp_range + (1 | marker)+ (1 | Sleeper), data = mor_fed_temp, family = binomial("logit"))
ss <- getME(mor_fed_num_ms_temp,c("theta","fixef"))
mor_fed_num_ms_temp <- update(mor_fed_num_ms_temp,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=5e5)))
summary(mor_fed_num_ms_temp)
mor_fed_num_ms_mean_temp <- glmer(Dead~Fed + Location + Treatment + Location * Treatment + Total.Loc + Total.Loc*Treatment +
mean_temp + (1 | marker)+ (1 | Sleeper), data = mf_mos_temp, family = binomial("logit"))
ss <- getME(mor_fed_num_ms_mean_temp,c("theta","fixef"))
mor_fed_num_ms_mean_temp <- update(mor_fed_num_ms_mean_temp,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=5e5)))
ss <- getME(mor_fed_num_ms_mean_temp,c("theta","fixef"))
mor_fed_num_ms_mean_temp <- update(mor_fed_num_ms_mean_temp,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=5e5)))
summary(bf_num_loc_Rand_trial_temp_range)
source("~/Desktop/Second project/R/0610 loop.R")
library(lme4)
library(tidyverse)
library(DHARMa)
library(lubridate)
library(MASS)
library(merTools)
library(ggpubr)
library(ggpmisc)
library(fitdistrplus)
library(broom)
mor_fed_num_ms_mean_temp <- glmer(Dead~Fed + Location + Treatment + Location * Treatment + Total.Loc + Total.Loc*Treatment +
mean_temp + (1 | marker)+ (1 | Sleeper), data = mor_fed_temp, family = binomial("logit"))
ss <- getME(mor_fed_num_ms_mean_temp,c("theta","fixef"))
mor_fed_num_ms_mean_temp <- update(mor_fed_num_ms_mean_temp,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=5e5)))
summary(mor_fed_num_ms_mean_temp)
mor_fed_num_ms_diu_temp_range <- glmer(Dead~Fed + Location + Treatment + Location * Treatment + Total.Loc + Total.Loc*Treatment +
diurnal_temp_range + (1 | marker)+ (1 | Sleeper), data = mf_mos_temp,
family = binomial("logit"))
mor_fed_num_ms_diu_temp_range <- glmer(Dead~Fed + Location + Treatment + Location * Treatment + Total.Loc + Total.Loc*Treatment +
diurnal_temp_range + (1 | marker)+ (1 | Sleeper), data = mor_fed_temp,
family = binomial("logit"))
ss <- getME(mor_fed_num_ms_diu_temp_range,c("theta","fixef"))
mor_fed_num_ms_diu_temp_range <- update(mor_fed_num_ms_diu_temp_range,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=5e5)))
summary(mor_fed_num_ms_diu_temp_range)
mor_fed_num_ms_mean_temp_trial <- glmer(Dead~Fed + Location + Treatment + Location * Treatment + Total.Loc + Total.Loc*Treatment +
trial_mean_temp + (1 | marker)+ (1 | Sleeper), data = mor_fed_temp,
family = binomial("logit"))
ss <- getME(mor_fed_num_ms_mean_temp_trial,c("theta","fixef"))
mor_fed_num_ms_mean_temp_trial <- update(mor_fed_num_ms_mean_temp_trial,start=ss, control=glmerControl(optimizer="bobyqa",
optCtrl = list(maxfun=5e5)))
summary(mor_fed_num_ms_mean_temp_trial)
mor_fed_num_ms_temp <- glmer(Dead~Fed + Location + Treatment + Location * Treatment + Total.Loc + Total.Loc*Treatment +
trial_temp_range + (1 | marker)+ (1 | Sleeper), data = mor_fed_temp, family = binomial("logit"))
ss <- getME(mor_fed_num_ms_temp,c("theta","fixef"))
mor_fed_num_ms_temp <- update(mor_fed_num_ms_temp,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=5e5)))
summary(mor_fed_num_ms_temp)
View(BF_temp)
View(BF_temp_trial)
summary(mor_fed_num_ms_diu_temp_range)
predict_mor <- predict(mor_fed_num_ms_diu_temp_range, mor_fed_temp, type = "response")
pred_mor <- cbind(mor_fed_temp, predict_mor)
View(pred_mor)
model_5_1_trial_range <- glmer.nb(formula = Count~Location + WashedStatus+ (1|marker) + trial_temp_range, data = n_mos)
summary(model_5_1_trial_range)
write.csv(tidy(model_5_1_trial_range), "Mosquito count best model.csv")
ggplot(bf_quant, aes(color = Location, fill = Location))+
geom_point(aes(x = Total.Loc, y = Bloodfed))+
facet_grid(vars(Location), vars(WashedStatus))+
labs(title = "Blood-feeding correponding to number of mosquitoes",
x = "Number of mosquitoes", y = "Blood-feeding rate")+
geom_smooth(aes(x = Total.Loc, y = pred_bf),formula = y~x,method = glm,
method.args= list(family="binomial"), col = "black")+
theme_bw()
bf_quant <- bf_mos%>%
dplyr::select(c("Village","Date","Treatment","Location", "Bloodfed", "Insecticide",
"Total","WashedStatus","Sleeper","marker","Nets", "Hut")) %>%
right_join(mor_fed, by=c("Village","Date","Treatment","Location", "Insecticide",
"Total","WashedStatus","Sleeper","marker","Nets", "Hut"))
bf_quant <- cbind(bf_quant, pred_bf)
bf_quant$WashedStatus <-  relevel(as.factor(bf_quant$WashedStatus), ref = "UTN")
View(bf_quant)
ggplot(bf_quant, aes(color = Location, fill = Location))+
geom_point(aes(x = Total.Loc, y = Bloodfed))+
facet_grid(vars(Location), vars(WashedStatus))+
labs(title = "Blood-feeding correponding to number of mosquitoes",
x = "Number of mosquitoes", y = "Blood-feeding rate")+
geom_line(aes(x = Total.Loc, y = pred_bf), col = "black")+
theme_bw()
ggplot(bf_quant, aes(color = Location, fill = Location))+
geom_point(aes(x = Total.Loc, y = Bloodfed))+
facet_grid(vars(Location), vars(WashedStatus))+
labs(title = "Blood-feeding correponding to number of mosquitoes",
x = "Number of mosquitoes", y = "Blood-feeding rate")+
geom_jitter(aes(x = Total.Loc, y = pred_bf), col = "black")+
theme_bw()
pred_bf <- predict(bf_num_loc_Rand, mor_fed, interval = "confidence")
pred_bf <- predict(bf_num_loc_Rand, mor_fed, type = "response", interval = "confidence")
View(pred_bf)
pred_bf
help("predict")
library(stats)
pred_bf <- predict(bf_num_loc_Rand, mor_fed, type = "response", se.fit = TRUE)
pred_bf
pred_bf <- predict(bf_num_loc_Rand, mor_fed, type = "response", se.fit = TRUE)
summary(bf_num_loc_Rand)
max(mor_fed$Total.Loc)
rep("UTN",52*6)
seq(0,52*6,1)
max(mor_fed$marker)
216*6*6
mor_fed$marker
distinct(mor_fed$marker)
max(mor_fed$marker)
mind(mor_fed$marker)
min(mor_fed$marker)
bf_dataframe <- data.frame(Total.Loc = rep(seq(0,52,1),7776), WashedStatus = rep("UTN",7776),
Location = rep("Net",7776), Hut = rep(seq(1,6,1),216),
marker = rep(seq(1,216,1),36), Sleeper =rep(seq(1,6,1),216))
pred_bf <- predict(bf_num_loc_Rand, bf_dataframe, type = "response", se.fit = TRUE)
summary(bf_num_loc_Rand)
rep_len(1:6,52)
rep_len(1:216,52)
mor_fed$Sleeper
levels(mor_fed$Sleeper)
rep_len(c("Te.S1","Te.S2", "Te.S3", "Te.S4", "Te.S5", "Te.S6"),52)
bf_dataframe <- data.frame(Total.Loc = seq(0,52,1), WashedStatus = rep("UTN",53),
Location = rep("Net",53), Hut = rep_len(1:6,53),
marker = rep(seq(1,216,1),53),
Sleeper =rep_len(c("Te.S1","Te.S2", "Te.S3", "Te.S4", "Te.S5", "Te.S6"),53))
bf_dataframe <- data.frame(Total.Loc = seq(0,52,1), WashedStatus = rep("UTN",53),
Location = rep("Net",53), Hut = rep_len(1:6,53),
marker = rep(1:216,53),
Sleeper =rep_len(c("Te.S1","Te.S2", "Te.S3", "Te.S4", "Te.S5", "Te.S6"),53))
View(bf_dataframe)
pred_bf <- predict(bf_num_loc_Rand, bf_dataframe, type = "response", se.fit = TRUE)
summary(bf_num_loc_Rand)
levels(mor_fed$Hut)
bf_dataframe <- data.frame(Total.Loc = seq(0,52,1), WashedStatus = rep("UTN",53),
Location = rep("Net",53), marker = rep(1:216,53),
Hut = rep_len(c("Te.C1","Te.C2", "Te.C3", "Te.C4", "Te.C5", "Te.C6"),53),
Sleeper =rep_len(c("Te.S1","Te.S2", "Te.S3", "Te.S4", "Te.S5", "Te.S6"),53))
View(bf_dataframe)
pred_bf <- predict(bf_num_loc_Rand, bf_dataframe, type = "response", se.fit = TRUE)
View(mor_fed)
typeof(mor_fed)
typeof(mor_fed$marker)
typeof(mor_fed$WashedStatus)
levels(mor_fed$WashedStatus)
class(mor_fed$WashedStatus)
class(mor_fed$Total.Loc)
class(mor_fed$marker)
bf_dataframe <- data.frame(Total.Loc = as.numeric(seq(0,52,1)), WashedStatus = rep(as.factor("UTN"),53),
Location = rep("Net",53), marker = rep(1:216,53),
Hut = rep_len(c("Te.C1","Te.C2", "Te.C3", "Te.C4", "Te.C5", "Te.C6"),53),
Sleeper =rep_len(c("Te.S1","Te.S2", "Te.S3", "Te.S4", "Te.S5", "Te.S6"),53))
pred_bf <- predict(bf_num_loc_Rand, bf_dataframe, type = "response", se.fit = TRUE)
bf_dataframe <- data.frame(Total.Loc = as.numeric(seq(0,52,1)), WashedStatus = rep(as.factor("UTN"),53),
Location = rep(as.factor("Net"),53), marker = rep(1:216,53),
Hut = rep_len(c("Te.C1","Te.C2", "Te.C3", "Te.C4", "Te.C5", "Te.C6"),53),
Sleeper =rep_len(c("Te.S1","Te.S2", "Te.S3", "Te.S4", "Te.S5", "Te.S6"),53))
pred_bf <- predict(bf_num_loc_Rand, bf_dataframe, type = "response", se.fit = TRUE)
unique(as.numeric(row.names(ranef(bf_num_loc_Rand)$ID)))
pred_bf <- predict(bf_num_loc_Rand, mor_fed, type = "response")
bf_pred <- bf_quant %>%
group_by(WashedStatus, Location, Total.Loc) %>%
mutate(sd = sqrt(var(pred_bf)),
lwr = pred_bf - 1.96*sd,
upr = pred_bf +1.96*sd)
View(bf_pred)
help("predcit")
help("predict")
