mor_1_1 <- glm(Dead~Location, data = mor_reg, family = binomial("logit"))
bf_1_1 <- glm(Fed~Insecticide, data = bf_reg, family =  binomial("log"))
levels(bf_reg$Location)
summary(bf_1_2)
bf_1_2 <- glm(Fed~Insecticide, data = bf_reg, family =  binomial("log"))
summary(bf_1_2)
bf_1_4 <- glm(Fed~Insecticide, data = bf_reg, family =  binomial("log"))
summary(bf_1_4)
#AIC: 5306.3
bf_1_3 <- glm(Fed~WashedStatus, data = bf_reg, family =  binomial("log"))
summary(bf_1_3)
bf_1_3 <- glm(Fed~Treatment, data = bf_reg, family =  binomial("log"))
summary(bf_1_3)
###One variable model
bf_1_1 <- glm(Fed~Location, data = bf_reg, family =  binomial("logit"))
summary(bf_1_1)
bf_1_4 <- glm(Fed~Insecticide, data = bf_reg, family =  binomial("logit"))
summary(bf_1_4)
bf_1_3 <- glm(Fed~Treatment, data = bf_reg, family =  binomial("logit"))
summary(bf_1_3)
summary(bf_1_1)
bf_1_5 <- glm(Fed~Nets, data = bf_reg, family =  binomial("logit"))
summary(bf_1_5)
###One variable model with random effect
bf_1_1_obs <- glmer(Fed~Location + (1|marker), data = bf_reg, family =  binomial("logit"))
summary(bf_1_1_obs)
bf_1_2_obs <- glmer(Fed~WashedStatus+ (1|marker), data = bf_reg, family =  binomial("logit"))
summary(bf_1_2_obs)
#AIC: 5306.7
bf_1_3_obs <- glmer(Fed~Treatment+ (1|marker), data = bf_reg, family =  binomial("logit"))
summary(bf_1_3_obs)
bf_1_4_obs <- glmer(Fed~Insecticide+ (1|marker), data = bf_reg, family =  binomial("logit"))
summary(bf_1_4_obs)
bf_1_5_obs <- glmer(Fed~Nets+ (1|marker), data = bf_reg, family =  binomial("logit"))
summary(bf_1_5_obs)
bf_1_1_hut <- glmer(Fed~Location + (1|Hut), data = bf_reg, family =  binomial("logit"))
summary(bf_1_1_hut)
bf_1_2_hut <- glmer(Fed~WashedStatus+ (1|Hut), data = bf_reg, family =  binomial("logit"))
summary(bf_1_2_hut)
#AIC: 4080.6
bf_1_3_hut <- glmer(Fed~Treatment+ (1|Hut), data = bf_reg, family =  binomial("logit"))
summary(bf_1_3_hut)
#AIC: 4079.6
bf_1_4_hut <- glmer(Fed~Insecticide+ (1|Hut), data = bf_reg, family =  binomial("logit"))
summary(bf_1_4_hut)
#AIC: 4080.5
bf_1_5_hut <- glmer(Fed~Nets+ (1|Hut), data = bf_reg, family =  binomial("logit"))
summary(bf_1_5_hut)
anova(bf_1_1_hut,bf_1_2_hut)
anova(bf_1_1_hut,bf_1_2_hut,bf_1_3_hut, bf_1_4_hut,bf_1_5_hut)
summary(bf_1_1_hut)
summary(bf_1_2_hut)
summary(bf_1_3_hut)
summary(bf_1_4_hut)
summary(bf_1_5_hut)
summary(bf_1_5_hut)
summary(bf_1_4_hut)
summary(bf_1_3_hut)
summary(bf_1_2_hut)
summary(bf_1_3_hut)
summary(bf_1_4_hut)
summary(bf_1_5_hut)
summary(bf_1_2_obs)
summary(bf_1_3_obs)
summary(bf_1_4_obs)
summary(bf_1_5_obs)
anova(bf_1_1_hut,bf_1_2_hut,bf_1_3_hut, bf_1_4_hut,bf_1_5_hut)
bf_2_1 <- glm(Fed~Location + Treatment, data = bf_reg, family =  binomial("logit"))
summary(bf_2_1)
bf_2_2 <- glm(Fed~Location +WashedStatus, data = bf_reg, family =  binomial("logit"))
summary(bf_2_2)
bf_2_3 <- glm(Fed~Location +Insecticide, data = bf_reg, family =  binomial("logit"))
summary(bf_2_3)
bf_2_4 <- glm(Fed~Location +Nets, data = bf_reg, family =  binomial("logit"))
summary(bf_2_4)
bf_2_1_int <- glm(Fed~Location + Treatment+Location * Treatment, data = bf_reg, family =  binomial("logit"))
summary(bf_2_1_int)
#AIC: 3800.7
bf_2_2_int <- glm(Fed~Location +WashedStatus + Location *WashedStatus, data = bf_reg, family =  binomial("logit"))
summary(bf_2_2_int)
bf_2_3_int <- glm(Fed~Location +Insecticide +Location*Insecticide, data = bf_reg, family =  binomial("logit"))
summary(bf_2_3_int)
bf_2_4_int <- glm(Fed~Location +Nets + Location*Nets, data = bf_reg, family =  binomial("logit"))
summary(bf_2_4_int)
bf_2_1_int_obs <- glm(Fed~Location + Treatment+Location * Treatment + (1|marker), data = bf_reg, family =  binomial("logit"))
summary(bf_2_1_int_obs)
bf_2_1_int_obs <- glmer(Fed~Location + Treatment+Location * Treatment + (1|marker), data = bf_reg, family =  binomial("logit"))
summary(bf_2_1_int_obs)
bf_2_1_obs <- glmer(Fed~Location + Treatment + (1|marker), data = bf_reg, family =  binomial("logit"))
summary(bf_2_1_obs)
bf_2_1_obs <- update(bf_2_1_obs, control = glmerControl(optimizer = "bobyqa"))
summary(bf_2_1_obs)
bf_2_2_obs <- glmer(Fed~Location +WashedStatus + (1|marker), data = bf_reg, family =  binomial("logit"))
bf_2_2_obs <- update(bf_2_2_obs, control = glmerControl(optimizer = "bobyqa"))
bf_2_2_obs <- glmer(Fed~Location +WashedStatus + (1|marker), data = bf_reg, family =  binomial("logit"))
summary(bf_2_2_obs)
bf_2_3_obs <- glmer(Fed~Location +Insecticide + (1|marker), data = bf_reg, family =  binomial("logit"))
bf_2_3_obs <- update(bf_2_3_obs, control = glmerControl(optimizer = "bobyqa"))
summary(bf_2_3_obs)
bf_2_3_obs <- glmer(Fed~Location +Insecticide + (1|marker), data = bf_reg, family =  binomial("logit"))
summary(bf_2_3_obs)
bf_2_4_obs <- glmer(Fed~Location +Nets + (1|marker), data = bf_reg, family =  binomial("logit"))
summary(bf_2_4_obs)
###Two variable model with observational random effect
bf_2_1_obs <- glmer(Fed~Location + Treatment + (1|marker), data = bf_reg, family =  binomial("logit"))
bf_2_1_obs <- update(bf_2_1_obs, control = glmerControl(optimizer = "bobyqa"))
summary(bf_2_1_obs)
#AIC: 3822.1
anova(bf_2_1_int,bf_2_2_int,bf_2_3_int,bf_2_4_int)
###Two variable model with interaction and observational random effect
bf_2_1_int_obs <- glmer(Fed~Location + Treatment+Location * Treatment + (1|marker), data = bf_reg, family =  binomial("logit"))
bf_2_1_obs <- update(bf_2_1_obs, control = glmerControl(optimizer = "bobyqa"))
bf_2_1_int_obs <- update(bf_2_1_int_obs, control = glmerControl(optimizer = "bobyqa"))
summary(bf_2_1_int_obs)
bf_2_2_int_obs <- glmer(Fed~Location +WashedStatus + Location *WashedStatus+ (1|marker), data = bf_reg, family =  binomial("logit"))
bf_2_1_obs <- update(bf_2_1_obs, control = glmerControl(optimizer = "bobyqa"))
bf_2_2_int_obs <- update(bf_2_2_int_obs, control = glmerControl(optimizer = "bobyqa"))
summary(bf_2_2_int_obs)
bf_2_3_int_obs <- glmer(Fed~Location +Insecticide +Location*Insecticide+ (1|marker), data = bf_reg, family =  binomial("logit"))
bf_2_3_int_obs <- update(bf_2_3_int_obs, control = glmerControl(optimizer = "bobyqa"))
bf_2_3_int_obs <- glmer(Fed~Location +Insecticide +Location*Insecticide+ (1|marker), data = bf_reg, family =  binomial("logit"))
summary(bf_2_3_int_obs)
bf_2_4_int_obs <- glmer(Fed~Location +Nets + Location*Nets+ (1|marker), data = bf_reg, family =  binomial("logit"))
bf_2_4_int_obs <- update(bf_2_4_int_obs, control = glmerControl(optimizer = "bobyqa"))
summary(bf_2_4_int_obs)
summary(bf_2_1_int_obs)
summary(bf_2_2_int_obs)
summary(bf_2_3_int_obs)
summary(bf_2_4_int_obs)
###Two variable model with interaction and observational and hut random effect
bf_2_1_int_rand <- glmer(Fed~Location + Treatment+Location * Treatment + (1|marker) + (1|Hut),
data = bf_reg, family =  binomial("logit"))
bf_2_1_int_rand <- update(bf_2_1_int_rand, control = glmerControl(optimizer = "bobyqa"))
bf_2_2_int_obs <- update(bf_2_2_int_obs, control = glmerControl(optimizer = "bobyqa"))
bf_2_2_int_obs <- glmer(Fed~Location +WashedStatus + Location *WashedStatus+ (1|marker), data = bf_reg, family =  binomial("logit"))
bf_2_2_int_obs <- update(bf_2_2_int_obs, control = glmerControl(optimizer = "bobyqa"))
summary(bf_2_2_int_obs)
bf_2_2_int_rand <- glmer(Fed~Location +WashedStatus + Location *WashedStatus+ (1|marker)+ (1|Hut),
data = bf_reg, family =  binomial("logit"))
bf_2_2_int_obs <- update(bf_2_2_int_obs, control = glmerControl(optimizer = "bobyqa"))
bf_2_1_int_rand <- update(bf_2_1_int_rand, control = glmerControl(optimizer = "bobyqa"))
summary(bf_2_2_int_obs)
bf_2_2_int_rand <- update(bf_2_2_int_rand, control = glmerControl(optimizer = "bobyqa"))
?isSingular
summary(bf_2_1_int_rand)
summary(bf_2_2_int_rand)
bf_2_3_int_rand <- glmer(Fed~Location +Insecticide +Location*Insecticide+ (1|marker) + (1|Hut),
data = bf_reg, family =  binomial("logit"))
bf_2_3_int_rand <- update(bf_2_3_int_rand, control = glmerControl(optimizer = "bobyqa"))
summary(bf_2_3_int_rand)
bf_2_4_int_rand <- glmer(Fed~Location +Nets + Location*Nets+ (1|marker) + (1|Hut),
data = bf_reg, family =  binomial("logit"))
bf_2_4_int_rand <- update(bf_2_4_int_rand, control = glmerControl(optimizer = "bobyqa"))
summary(bf_2_4_int_obs)
summary(bf_2_4_int_rand)
2.256e+00
summary(bf_2_1_obs)
summary(bf_2_2_obs)
summary(bf_2_3_obs)
summary(bf_2_4_obs)
summary(bf_2_1_int_obs)
summary(bf_2_2_int_obs)
summary(bf_2_3_int_obs)
summary(bf_2_4_int_obs)
bf_0_obs <- glmer(Fed ~1+(1|marker), data = bf_reg, family =  binomial("log"))
###Intercept only model
bf_0 <- glm(Fed~1, data = bf_reg, family =  binomial("logit"))
bf_0_obs <- glmer(Fed ~1+(1|marker), data = bf_reg, family =  binomial("logit"))
summary(bf_0)
bf_0_obs <- glmer(Fed ~1+(1|marker), data = bf_reg, family =  binomial("logit"))
summary(bf_0_obs)
bf_0_hut <- glmer(Fed ~1+(1|Hut), data = bf_reg, family =  binomial("logit"))
summary(bf_0_hut)
bf_0_rand <- glmer(Fed ~1+(1|marker)+(1|Hut), data = bf_reg, family =  binomial("logit"))
summary(bf_0_obs)
summary(bf_0_rand)
head(n_mos)
###glmms
library(lme4)
library(tidyverse)
library(DHARMa)
library(lubridate)
library(MASS)
library(merTools)
library(ggpubr)
library(ggpmisc)
library(nnet)
View(n_mos)
####Compare number of mosquitoes in each location by different treatment
###Barplot of average number of mosquito in each location by Treatment (With/without errorbar)
n_mos %>%
group_by(Treatment, Location) %>%
summarise(Avg = mean(Count), max = max(Count), min = min(Count)) %>%
ggplot(aes(x = Location, y = Avg, color = Location))+
geom_col(aes(fill= Location))+
#geom_errorbar(aes(x=Location, ymin=min, ymax= max), color = 'steelblue')+
facet_wrap(vars(Location))+
labs(title = "Mean and range of number of mosquitoes in each location by treatment")+
theme(plot.title = element_text(hjust = 0.5, size = 12.5),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
strip.text = element_text(size = 10))
####Compare number of mosquitoes in each location by different treatment
###Barplot of average number of mosquito in each location by Treatment (With/without errorbar)
n_mos %>%
group_by(Treatment, Location) %>%
summarise(Avg = mean(Count), max = max(Count), min = min(Count)) %>%
ggplot(aes(x = Treatment, y = Avg, color = Treatment))+
geom_col(aes(fill= Location))+
#geom_errorbar(aes(x=Location, ymin=min, ymax= max), color = 'steelblue')+
facet_wrap(vars(Location))+
labs(title = "Mean and range of number of mosquitoes in each location by treatment")+
theme(plot.title = element_text(hjust = 0.5, size = 12.5),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
strip.text = element_text(size = 10))
####Compare number of mosquitoes in each location by different treatment
###Barplot of average number of mosquito in each location by Treatment (With/without errorbar)
n_mos %>%
group_by(Treatment, Location) %>%
summarise(Avg = mean(Count), max = max(Count), min = min(Count)) %>%
ggplot(aes(x = Treatment, y = Avg, color = Treatment))+
geom_col(aes(fill= Treatment))+
#geom_errorbar(aes(x=Location, ymin=min, ymax= max), color = 'steelblue')+
facet_wrap(vars(Location))+
labs(title = "Mean and range of number of mosquitoes in each location by treatment")+
theme(plot.title = element_text(hjust = 0.5, size = 12.5),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
strip.text = element_text(size = 10))
####Compare number of mosquitoes in each location by different treatment
###Barplot of average number of mosquito in each location by Treatment (With/without errorbar)
n_mos %>%
group_by(Treatment, Location) %>%
summarise(Avg = mean(Count), max = max(Count), min = min(Count)) %>%
ggplot(aes(x = Treatment, y = Avg, color = Treatment))+
geom_col(aes(fill= Treatment))+
#geom_errorbar(aes(x=Location, ymin=min, ymax= max), color = 'steelblue')+
facet_wrap(vars(Location),ncol = 1)+
labs(title = "Mean and range of number of mosquitoes in each location by treatment")+
theme(plot.title = element_text(hjust = 0.5, size = 12.5),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
strip.text = element_text(size = 10))
ggsave("Average of number of mosquitoes by location and treatment.jpeg",
width = 8, height = 5.5)
ggsave("Average of number of mosquitoes by location and treatment.jpeg")
####Boxplot of the number of mosquitoes by location and treatment and dotplot of the average number
n_mos %>%
ggplot(aes(x = Location, y = Count, color = Location))+
geom_boxplot(aes( fill= Location), alpha = 0.5)+
stat_summary(fun.y = mean, geom="point", shape=23, size=4, color="red", fill="red") +
facet_grid(Treatment~.)+
labs(title = "Number of mosquitoes in each location by treatment",
y = "Number of mosquitoes")+
theme(plot.title = element_text(hjust = 0.5, size = 12.5),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
strip.text = element_text(size = 10))
####Boxplot of the number of mosquitoes by location and treatment and dotplot of the average number
n_mos %>%
ggplot(aes(x = Location, y = Count, color = Location))+
geom_boxplot(aes( fill= Location), alpha = 0.5)+
stat_summary(fun.y = mean, geom="point", shape=23, size=4, color="red", fill="red") +
facet_grid(Location~.)+
labs(title = "Number of mosquitoes in each location by treatment",
y = "Number of mosquitoes")+
theme(plot.title = element_text(hjust = 0.5, size = 12.5),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
strip.text = element_text(size = 10))
####Boxplot of the number of mosquitoes by location and treatment and dotplot of the average number
n_mos %>%
ggplot(aes(x = Location, y = Count, color = Location))+
geom_boxplot(aes( fill= Location), alpha = 0.5)+
stat_summary(fun.y = mean, geom="point", shape=23, size=4, color="red", fill="red") +
facet_wrap(vars(Treatment))+
labs(title = "Number of mosquitoes in each location by treatment",
y = "Number of mosquitoes")+
theme(plot.title = element_text(hjust = 0.5, size = 12.5),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
strip.text = element_text(size = 10))
####Compare number of mosquitoes in each location by different treatment
###Barplot of average number of mosquito in each location by Treatment (With/without errorbar)
n_mos %>%
group_by(Treatment, Location) %>%
summarise(Avg = mean(Count), max = max(Count), min = min(Count)) %>%
ggplot(aes(x = Treatment, y = Avg, color = Treatment))+
geom_col(aes(fill= Treatment))+
#geom_errorbar(aes(x=Location, ymin=min, ymax= max), color = 'steelblue')+
facet_grid(Location~.)+
labs(title = "Mean and range of number of mosquitoes in each location by treatment")+
theme(plot.title = element_text(hjust = 0.5, size = 12.5),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
strip.text = element_text(size = 10))
ggsave("Average of number of mosquitoes by location and treatment.jpeg")
summary(model_5_5)
####Compare number of mosquitoes in each location by different treatment
###Barplot of average number of mosquito in each location by Treatment (With/without errorbar)
n_mos %>%
ggplot(aes(x = Treatment, y = Count, color = Treatment, fill= Treatment))+
geom_boxplot()+
stat_summary(fun = mean, geom="point", shape=22, size=6) +
#geom_errorbar(aes(x=Location, ymin=min, ymax= max), color = 'steelblue')+
facet_grid(Location~.)+
labs(title = "Mean and range of number of mosquitoes in each location by treatment")+
theme(plot.title = element_text(hjust = 0.5, size = 12.5),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
strip.text = element_text(size = 10))
####Compare number of mosquitoes in each location by different treatment
###Barplot of average number of mosquito in each location by Treatment (With/without errorbar)
n_mos %>%
ggplot(aes(x = Treatment, y = Count, color = Treatment))+
geom_boxplot()+
stat_summary(fun = mean, geom="point", shape=22, size=6, color = 'red') +
#geom_errorbar(aes(x=Location, ymin=min, ymax= max), color = 'steelblue')+
facet_grid(Location~.)+
labs(title = "Mean and range of number of mosquitoes in each location by treatment")+
theme(plot.title = element_text(hjust = 0.5, size = 12.5),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
strip.text = element_text(size = 10))
####Compare number of mosquitoes in each location by different treatment
###Barplot of average number of mosquito in each location by Treatment (With/without errorbar)
n_mos %>%
ggplot(aes(x = Treatment, y = Count, color = Treatment))+
geom_boxplot()+
stat_summary(fun = mean, geom="point", shape=23, size=6, color = 'red') +
#geom_errorbar(aes(x=Location, ymin=min, ymax= max), color = 'steelblue')+
facet_grid(Location~.)+
labs(title = "Mean and range of number of mosquitoes in each location by treatment")+
theme(plot.title = element_text(hjust = 0.5, size = 12.5),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
strip.text = element_text(size = 10))
####Compare number of mosquitoes in each location by different treatment
###Barplot of average number of mosquito in each location by Treatment (With/without errorbar)
n_mos %>%
ggplot(aes(x = Treatment, y = Count, color = Treatment))+
geom_boxplot()+
stat_summary(fun = mean, geom="point", shape=23, size=6, color = 'red', fill = 'red') +
#geom_errorbar(aes(x=Location, ymin=min, ymax= max), color = 'steelblue')+
facet_grid(Location~.)+
labs(title = "Mean and range of number of mosquitoes in each location by treatment")+
theme(plot.title = element_text(hjust = 0.5, size = 12.5),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
strip.text = element_text(size = 10))
####Compare number of mosquitoes in each location by different treatment
###Barplot of average number of mosquito in each location by Treatment (With/without errorbar)
n_mos %>%
ggplot(aes(x = Treatment, y = Count, color = Treatment))+
geom_boxplot()+
stat_summary(fun = mean, geom="point", shape=23, size=6, color = 'red', fill = 'red') +
#geom_errorbar(aes(x=Location, ymin=min, ymax= max), color = 'steelblue')+
facet_grid(Location~.)+
labs(title = "Mean and range of number of mosquitoes in each location by treatment")+
theme(plot.title = element_text(hjust = 0.5, size = 12.5),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
strip.text = element_text(size = 10),
axis.title.x = element_blank())
####Compare number of mosquitoes in each location by different treatment
###Barplot of average number of mosquito in each location by Treatment (With/without errorbar)
n_mos %>%
ggplot(aes(x = Treatment, y = Count, color = Treatment))+
geom_boxplot()+
stat_summary(fun = mean, geom="point", shape=23, size=6, color = 'red', fill = 'red') +
#geom_errorbar(aes(x=Location, ymin=min, ymax= max), color = 'steelblue')+
facet_grid(Location~.)+
labs(title = "Mean and range of number of mosquitoes in each location by treatment",
x = "Number of mosquitoes")+
theme(plot.title = element_text(hjust = 0.5, size = 12.5),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
strip.text = element_text(size = 10),
axis.title.x = element_blank())
####Compare number of mosquitoes in each location by different treatment
###Barplot of average number of mosquito in each location by Treatment (With/without errorbar)
n_mos %>%
ggplot(aes(x = Treatment, y = Count, color = Treatment))+
geom_boxplot()+
stat_summary(fun = mean, geom="point", shape=23, size=4, color = 'red', fill = 'red') +
#geom_errorbar(aes(x=Location, ymin=min, ymax= max), color = 'steelblue')+
facet_grid(Location~.)+
labs(title = "Mean and range of number of mosquitoes in each location by treatment",
x = "Number of mosquitoes")+
theme(plot.title = element_text(hjust = 0.5, size = 12.5),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
strip.text = element_text(size = 10),
axis.title.x = element_blank())
ggsave("Average of number of mosquitoes by location and treatment.jpeg")
####Compare number of mosquitoes in each location by different treatment
###Barplot of average number of mosquito in each location by Treatment (With/without errorbar)
n_mos %>%
ggplot(aes(x = Treatment, y = Count, color = Treatment))+
geom_boxplot(aes(fill = Treatment), alpha = 0.6)+
stat_summary(fun = mean, geom="point", shape=23, size=4, color = 'red', fill = 'red') +
#geom_errorbar(aes(x=Location, ymin=min, ymax= max), color = 'steelblue')+
facet_grid(Location~.)+
labs(title = "Mean and range of number of mosquitoes in each location by treatment",
x = "Number of mosquitoes")+
theme(plot.title = element_text(hjust = 0.5, size = 12.5),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
strip.text = element_text(size = 10),
axis.title.x = element_blank())
####Compare number of mosquitoes in each location by different treatment
###Barplot of average number of mosquito in each location by Treatment (With/without errorbar)
n_mos %>%
ggplot(aes(x = Treatment, y = Count, color = Treatment))+
geom_boxplot(aes(fill = Treatment), alpha = 0.5)+
stat_summary(fun = mean, geom="point", shape=23, size=4, color = 'red', fill = 'red') +
#geom_errorbar(aes(x=Location, ymin=min, ymax= max), color = 'steelblue')+
facet_grid(Location~.)+
labs(title = "Mean and range of number of mosquitoes in each location by treatment",
x = "Number of mosquitoes")+
theme(plot.title = element_text(hjust = 0.5, size = 12.5),
axis.text.x = element_text(size = 13),
axis.text.y = element_text(size = 13),
strip.text = element_text(size = 10),
axis.title.x = element_blank())
ggsave("Average of number of mosquitoes by location and treatment.jpeg")
ggplot(n_mos, aes(x = Count))+
geom_histogram(aes(fill = Location), binwidth = 1, center = 0)+
facet_wrap(vars(Location))+
theme(plot.title = element_text(hjust = 0.5, size = 12))+
labs(title = 'Number of mosquitoes per night by Location')+
scale_x_continuous(breaks = seq(0, maxCount, 10))
ggplot(n_mos, aes(x = Count))+
geom_histogram(aes(fill = Location), binwidth = 1, center = 0)+
facet_wrap(vars(Location))+
theme(plot.title = element_text(hjust = 0.5, size = 12))+
labs(title = 'Number of mosquitoes per night by Location',
y = "Frequency", x = "Number of mosquitoes")+
scale_x_continuous(breaks = seq(0, maxCount, 10))
ggsave("Histogram of the number of mosquitoes by Location.jpeg",
width = 8, height = 4)
###Barplot of the whole dataset
n_mos %>%
distinct(Date, Treatment, .keep_all = TRUE) %>%
group_by(Date) %>%
mutate(Tot = sum(Total)) %>%
distinct(Date, Tot, .keep_all = TRUE) %>%
ggplot(aes(x = Tot))+
geom_histogram(fill = 'Dark green' ,binwidth = 1, center = 0)+
theme(plot.title = element_text(hjust = 0.5, size = 12))+
labs(title = 'Number of mosquitoes per night')
###Plot by Treatment
ggplot(n_mos, aes(x = Date, y = Count))+
geom_col(aes(fill = Location))+
facet_wrap(vars(Treatment), ncol = 2)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1.5),
plot.title = element_text(hjust = 0.5, size = 15))+
labs(title = 'Number of mosquitoes per night by Treatment')+
scale_x_date(date_breaks = "1 week")
ggplot(n_mos, aes(x = Total))+
geom_histogram(aes(fill = Treatment), binwidth = 1, center = 0)+
facet_wrap(vars(Treatment), ncol = 2)+
theme(plot.title = element_text(hjust = 0.5, size = 12))+
labs(title = 'Number of mosquitoes per night by Treatment')+
scale_x_continuous(breaks = seq(0, maxTotal, 10))
ggplot(n_mos, aes(x = Total))+
geom_histogram(aes(fill = Treatment), binwidth = 5, center = 0)+
facet_wrap(vars(Treatment), ncol = 2)+
theme(plot.title = element_text(hjust = 0.5, size = 12))+
labs(title = 'Number of mosquitoes per night by Treatment')+
scale_x_continuous(breaks = seq(0, maxTotal, 10))
ggplot(n_mos, aes(x = Total))+
geom_histogram(aes(fill = Treatment), binwidth = 3, center = 0)+
facet_wrap(vars(Treatment), ncol = 2)+
theme(plot.title = element_text(hjust = 0.5, size = 12))+
labs(title = 'Number of mosquitoes per night by Treatment')+
scale_x_continuous(breaks = seq(0, maxTotal, 10))
ggplot(n_mos, aes(x = Total))+
geom_histogram(aes(fill = Treatment), binwidth = 3, center = 0, alpha = 0.5)+
facet_wrap(vars(Treatment), ncol = 2)+
theme(plot.title = element_text(hjust = 0.5, size = 12))+
labs(title = 'Number of mosquitoes per night by Treatment')+
scale_x_continuous(breaks = seq(0, maxTotal, 10))
ggplot(n_mos, aes(x = Total))+
geom_histogram(aes(fill = Treatment), binwidth = 3, center = 0, alpha = 0.7)+
facet_wrap(vars(Treatment), ncol = 2)+
theme(plot.title = element_text(hjust = 0.5, size = 12))+
labs(title = 'Number of mosquitoes per night by Treatment')+
scale_x_continuous(breaks = seq(0, maxTotal, 10))
ggplot(n_mos, aes(x = Total))+
geom_histogram(aes(fill = Treatment), binwidth = 3, center = 0, alpha = 0.7)+
facet_wrap(vars(Treatment), ncol = 2)+
theme(plot.title = element_text(hjust = 0.5, size = 12),
strip.text = element_blank())+
labs(title = 'Number of mosquitoes per night by Treatment')+
scale_x_continuous(breaks = seq(0, maxTotal, 10))
ggplot(n_mos, aes(x = Total))+
geom_histogram(aes(fill = Treatment), binwidth = 3, center = 0, alpha = 0.7)+
facet_wrap(vars(Treatment), ncol = 2)+
theme(plot.title = element_text(hjust = 0.5, size = 12))+
labs(title = 'Number of mosquitoes per night by Treatment')+
scale_x_continuous(breaks = seq(0, maxTotal, 10))
ggplot(n_mos, aes(x = Total))+
geom_histogram(aes(fill = Treatment), binwidth = 3, center = 0, alpha = 0.7)+
facet_wrap(vars(Treatment), ncol = 2)+
theme(plot.title = element_text(hjust = 0.5, size = 12),
legend.position = "none")+
labs(title = 'Number of mosquitoes per night by Treatment')+
scale_x_continuous(breaks = seq(0, maxTotal, 10))
ggsave("Histogram of the number of mosquitoes by Treatment.jpeg",
width = 8, height = 6)
