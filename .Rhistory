data = mor_reg,  family = binomial("logit"))
summary(mor_num_1)
mor_num_obs <- glmer(Dead ~ Location + Treatment + Location * Treatment + Total.Loc + Treatment * Total.Loc + (1|marker),
data = mor_reg,  family = binomial("logit"))
mor_num_obs <- update(mor_num_obs, control = glmerControl(optimizer = "bobyqa"))
mor_num_obs <- glmer(Dead ~ Location + Treatment + Location * Treatment + Total.Loc + Treatment * Total.Loc + (1|marker),
data = mor_reg,  family = binomial("logit"))
ss <- getME(mor_num_obs,c("theta","fixef"))
mor_num_obs <- update(mor_num_obs,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=5e5)))
summary(mor_num_obs)
mor_num_Hut <- glmer(Dead ~ Location + Treatment + Location * Treatment + Total.Loc + Treatment * Total.Loc + (1|Hut),
data = mor_reg,  family = binomial("logit"))
ss <- getME(mor_num_Hut,c("theta","fixef"))
mor_num_Hut <- update(mor_num_Hut,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=5e5)))
mor_num_Slp <- glmer(Dead ~ Location + Treatment + Location * Treatment + Total.Loc + Treatment * Total.Loc + (1|Sleeper),
data = mor_reg,  family = binomial("logit") )
summary(mor_num_Hut)
mor_num_Hut <- update(mor_num_Hut, control = glmerControl(optimizer = "bobyqa"))
mor_num_Slp <- update(mor_num_Slp, control = glmerControl(optimizer = "bobyqa"))
mor_num_Slp <- glmer(Dead ~ Location + Treatment + Location * Treatment + Total.Loc + Treatment * Total.Loc + (1|Sleeper),
data = mor_reg,  family = binomial("logit") )
ss <- getME(mor_num_Slp,c("theta","fixef"))
mor_num_Slp <- update(mor_num_Slp,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=5e5)))
summary(mor_num_Slp)
mor_num_mS <- glmer(Dead ~ Location + Treatment + Location * Treatment + Total.Loc + Treatment * Total.Loc + (1|marker) + (1|Sleeper),
data = mor_reg,  family = binomial("logit"))
ss <- getME(mor_num_best,c("theta","fixef"))
mor_num_best <- update(mor_num_best,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=5e5)))
ss <- getME(mor_num_mS,c("theta","fixef"))
mor_num_mS <- update(mor_num_mS,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=5e5)))
summary(mor_num_mS)
mor_num_Rand <- glmer(Dead ~ Location + Treatment + Location * Treatment + Total.Loc + Treatment * Total.Loc
+ (1|marker) + (1|Hut) + (1|Sleeper),
data = mor_reg,  family = binomial("logit"))
ss <- getME(mor_num_Rand,c("theta","fixef"))
mor_num_Rand <- update(mor_num_Rand,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=5e5)))
summary(mor_num_Rand)
mor_fed <- cbind(mor_reg, bf_reg[,"Fed"])
View(mor_fed)
colnames(mor_fed)[13] <- "Fed"
mor_fed$Treatment <- relevel(as.factor(mor_fed$Treatment), ref = "UTN")
mor_fed$Location <- relevel(as.factor(mor_fed$Location), ref = "Net")
colnames(mor_fed)[13] <- "Fed"
View(mor_fed)
mor_fed <- cbind(mor_reg, bf_reg[,"Fed"])
View(mor_fed)
colnames(mor_fed)[14] <- "Fed"
###Sanity check
sum(mor_reg[,c(1:9,11)] != bf_reg[,1:10])
######Aggregate both blood feeding and number of mosquitoes by location into the model
mor_fed_num_ms <- glmer(Dead~Fed + Location + Treatment + Location * Treatment + Total.Loc + Total.Loc*Treatment +
(1 | marker)+ (1 | Sleeper), data = mor_fed, family = binomial("logit"))
ss <- getME(mor_fed_num_ms,c("theta","fixef"))
mor_fed_num_ms <- update(mor_fed_num_ms,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=5e5)))
summary(mor_fed_num_ms)
write.csv(tidy(mor_fed_num_ms), "Mortality n blood-fed n number best model.csv")
ggplot(m_mos, aes(y = Mortality, x=Location, color = Location))+
geom_boxplot()+
stat_summary(fun = mean, geom="point", shape=16, size=6, alpha = 0.7) +
facet_grid(vars(Treatment))+
labs(title = "Mortality by location and treatment")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(m_mos, aes(y = Mortality, x=Location, color = Location))+
geom_boxplot()+
stat_summary(fun = mean, geom="point", shape=16, size=6, alpha = 0.7) +
facet_wrap(vars(Treatment))+
labs(title = "Mortality by location and treatment")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(m_mos, aes(y = Mortality, x=Location, color = Location))+
geom_boxplot()+
stat_summary(fun = mean, geom="point", shape=16, size=6, alpha = 0.7, color = "red") +
facet_wrap(vars(Treatment))+
labs(title = "Mortality by location and treatment")+
theme(plot.title = element_text(hjust = 0.5))
theme(plot.title = element_text(hjust = 0.5))
theme(plot.title = element_text(hjust = 0.5))
ggplot(m_mos, aes(y = Mortality, x=Location, color = Location, fill = Location))+
geom_boxplot(alpha = 0.7)+
stat_summary(fun = mean, geom="point", shape=16, size=6, alpha = 0.7, color = "red") +
facet_wrap(vars(Treatment))+
labs(title = "Mortality by location and treatment")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(m_mos, aes(y = Mortality, x=Location, color = Location, fill = Location))+
geom_boxplot()+
stat_summary(fun = mean, geom="point", shape=16, size=6, alpha = 0.7, color = "red") +
facet_wrap(vars(Treatment))+
labs(title = "Mortality by location and treatment")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(m_mos, aes(y = Mortality, x=Location, color = Location))+
geom_boxplot()+
stat_summary(fun = mean, geom="point", shape=16, size=6, alpha = 0.7, color = "red") +
facet_wrap(vars(Treatment))+
labs(title = "Mortality by location and treatment")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(m_mos, aes(y = Mortality, x=Location, color = Location))+
geom_boxplot()+
stat_summary(fun = mean, geom="point", shape=16, size=6, alpha = 0.6, color = "red") +
facet_wrap(vars(Treatment))+
labs(title = "Mortality by location and treatment")+
theme(plot.title = element_text(hjust = 0.5))
ggsave("Mortality by location and treatment.jpeg",
device = jpeg, width = 8, height = 5.5)
#########Graphs
ggplot(bf_mos, aes(x=Location, y = Bloodfed, colour = Location))+
geom_boxplot()+
facet_wrap(vars(Treatment))+
stat_summary(fun = mean, geom="point", shape=16, size=5, alpha = 0.7) +
labs(title = "Blood feeding by location and treatment",
y = "Blood feeding rate")+
theme(plot.title = element_text(hjust = 0.5))
#########Graphs
ggplot(bf_mos, aes(x=Location, y = Bloodfed, colour = Location))+
geom_boxplot()+
facet_wrap(vars(Treatment))+
stat_summary(fun = mean, geom="point", shape=16, size=5, alpha = 0.7, color = "red") +
labs(title = "Blood feeding by location and treatment",
y = "Blood feeding rate")+
theme(plot.title = element_text(hjust = 0.5))
#########Graphs
ggplot(bf_mos, aes(x=Location, y = Bloodfed, colour = Location))+
geom_boxplot()+
facet_wrap(vars(Treatment))+
stat_summary(fun = mean, geom="point", shape=16, size=5, alpha = 0.5, color = "red") +
labs(title = "Blood feeding by location and treatment",
y = "Blood feeding rate")+
theme(plot.title = element_text(hjust = 0.5))
ggsave("Blood feeding by Location and Treatment.jpeg", device = jpeg,
width = 8, height = 5.5)
ggplot(bf_mos, aes(x=Location, y = Bloodfed, colour = Location))+
geom_boxplot()+
facet_grid(vars(Insecticide))+
stat_summary(fun = mean, geom="point", shape=16, size=5, alpha = 0.7) +
labs(title = "Blood feeding by location and insecticide",
y = "Blood feeding rate")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(bf_mos, aes(x=Location, y = Bloodfed, colour = Location))+
geom_boxplot()+
facet_grid(vars(Insecticide))+
stat_summary(fun = mean, geom="point", shape=16, size=5, alpha = 0.7, color = "red") +
labs(title = "Blood feeding by location and insecticide",
y = "Blood feeding rate")+
theme(plot.title = element_text(hjust = 0.5))
#########Graphs
ggplot(bf_mos, aes(x=Location, y = Bloodfed, colour = Location))+
geom_boxplot()+
facet_wrap(vars(Treatment))+
stat_summary(fun = mean, geom="point", shape=16, size=5, alpha = 0.7, color = "red") +
labs(title = "Blood feeding by location and treatment",
y = "Blood feeding rate")+
theme(plot.title = element_text(hjust = 0.5))
#########Graphs
ggplot(bf_mos, aes(x=Location, y = Bloodfed, colour = Location))+
geom_boxplot()+
facet_wrap(vars(Treatment))+
stat_summary(fun = mean, geom="point", shape=16, size=5, alpha = 0.5, color = "red") +
labs(title = "Blood feeding by location and treatment",
y = "Blood feeding rate")+
theme(plot.title = element_text(hjust = 0.5))
ggsave("Blood feeding by Location and Treatment.jpeg", device = jpeg,
width = 8, height = 5.5)
ggplot(bf_mos, aes(x=Location, y = Bloodfed, colour = Location))+
geom_boxplot()+
facet_grid(vars(Insecticide))+
stat_summary(fun = mean, geom="point", shape=16, size=5, alpha = 0.5, color = "red") +
labs(title = "Blood feeding by location and insecticide",
y = "Blood feeding rate")+
theme(plot.title = element_text(hjust = 0.5))
ggsave("Blood feeding by Location and Insecticide.jpeg", device = jpeg,
width = 8, height = 5.5)
#########Graphs
ggplot(bf_mos, aes(x=Location, y = Bloodfed, colour = Location))+
geom_boxplot()+
facet_wrap(vars(Treatment))+
stat_summary(fun = mean, geom="point", shape=16, size=5, alpha = 0.5, color = "red") +
labs(title = "Blood feeding by location and treatment",
y = "Blood feeding rate")+
theme(plot.title = element_text(hjust = 0.5))
ggsave("Blood feeding by Location and Treatment.jpeg", device = jpeg,
width = 8, height = 5.5)
ggplot(bf_mos, aes(x=Location, y = Bloodfed, colour = Location))+
geom_boxplot()+
facet_grid(vars(Insecticide))+
stat_summary(aes(fill = WashedStatus),fun = mean, geom="point", shape=16, size=5, alpha = 0.5, color = "red") +
labs(title = "Blood feeding by location and insecticide",
y = "Blood feeding rate")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(bf_mos, aes(x=Location, y = Bloodfed, colour = Location))+
geom_boxplot()+
facet_grid(vars(Insecticide))+
stat_summary(fun = mean, geom="point", shape=16, size=5, alpha = 0.5, color = "red") +
labs(title = "Blood feeding by location and insecticide",
y = "Blood feeding rate")+
theme(plot.title = element_text(hjust = 0.5))
####Plot mortality against the number of mosquitoes to observe the relationship
ggplot(mor_reg, aes(x = Total, y = Dead, color = Nets, fill = Nets))+
geom_point()+
facet_grid(vars(Location), vars(Treatment))+
labs(title = "Mosquito status correponding to number of mosquitoes",
x = "Number of mosquitoes")+
scale_y_continuous( breaks = c(0,1))+
theme(plot.title = element_text(hjust = 0.5))
ggsave("Mosquito status correponding to number of mosquito.jpeg", device = jpeg,
height = 5, width = 7.5)
####Plot mortality against the number of mosquitoes to observe the relationship
ggplot(m_mos, aes(x = Total, y = Mortality, color = Nets, fill = Nets))+
geom_point()+
facet_grid(vars(Location), vars(Treatment))+
labs(title = "Mortality correponding to number of mosquitoes",
x = "Number of mosquitoes")+
scale_y_continuous( breaks = seq(0,1,0.25), limits = c(0,1))+
theme(plot.title = element_text(hjust = 0.5))+
stat_smooth(method = "lm", formula = y~x)
ggsave("Mortality correponding to number of mosquito.jpeg", device = jpeg)
View(bf_mos)
View(m_mos)
View(mor_reg)
####Plot mortality against the number of mosquitoes to observe the relationship
m_mos_df <- m_mos %>%
gather("Loc", "Total.Loc", c("Total.Room","Total.Net","Total.Net")) %>%
mutate("Loc" = case_when("Loc" == "Total.Room" ~ "Room",
"Loc" == "Total.Net" ~ "Net",
"Loc" == "Total.Ver" ~ "Ver"))
View(m_mos_df)
####Plot mortality against the number of mosquitoes to observe the relationship
m_mos_df <- m_mos %>%
gather("Loc", "Total.Loc", c("Total.Room","Total.Net","Total.Ver")) %>%
mutate("Loc" = case_when("Loc" == "Total.Room" ~ "Room",
"Loc" == "Total.Net" ~ "Net",
"Loc" == "Total.Ver" ~ "Ver"))
View(m_mos_df)
####Plot mortality against the number of mosquitoes to observe the relationship
m_mos_df <- m_mos %>%
gather("Loc", "Total.Loc", c("Total.Room","Total.Net","Total.Ver"))
View(m_mos_df)
####Plot mortality against the number of mosquitoes to observe the relationship
m_mos_df <- m_mos %>%
gather("Loc", "Total.Loc", c("Total.Room","Total.Net","Total.Ver")) %>%
mutate(Loc.Tot = case_when(Loc == "Total.Room" ~ "Room",
Loc == "Total.Net" ~ "Net",
Loc == "Total.Ver" ~ "Veranda"))
View(m_mos_df)
sum(m_mos_df$Location !=  m_mos_df$Loc.Tot)
####Plot mortality against the number of mosquitoes to observe the relationship
m_mos_df <- m_mos %>%
gather("Loc", "Total.Loc", c("Total.Room","Total.Net","Total.Ver")) %>%
mutate(Loc.Tot = case_when(Loc == "Total.Room" ~ "Room",
Loc == "Total.Net" ~ "Net",
Loc == "Total.Ver" ~ "Veranda"))%>%
select(c("Village", "Date", "Treatment", "WashedStatus", "Mortality", "Loc.Tot", "Total.Loc",
"Hut", "Sleeper", "marker", "Insecticide", "Week", "Nets"))
####Plot mortality against the number of mosquitoes to observe the relationship
m_mos_df <- m_mos %>%
gather("Loc", "Total.Loc", c("Total.Room","Total.Net","Total.Ver")) %>%
mutate(Loc.Tot = case_when(Loc == "Total.Room" ~ "Room",
Loc == "Total.Net" ~ "Net",
Loc == "Total.Ver" ~ "Veranda"))%>%
dplyr::select(c("Village", "Date", "Treatment", "WashedStatus", "Mortality", "Loc.Tot", "Total.Loc",
"Hut", "Sleeper", "marker", "Insecticide", "Week", "Nets"))
View(m_mos_df)
m_mos_df <- left_join(m_mos_df, m_mos, by = c("Village", "Date", "Treatment", "WashedStatus", "Mortality", "Loc.Tot", "Total.Loc",
"Hut", "Sleeper", "marker", "Insecticide", "Week", "Nets"))
m_mos_df <- left_join(m_mos, m_mos_df, by = c("Village", "Date", "Treatment", "WashedStatus", "Mortality",
"Hut", "Sleeper", "marker", "Insecticide", "Week", "Nets"))
View(m_mos_df)
m_mos_df <- left_join(m_mos, m_mos_df, by = c("Village", "Date", "Treatment", "WashedStatus", "Mortality",
"Hut", "Sleeper", "marker", "Insecticide", "Week", "Nets",
"Loc.Tot" == "Location"))
m_mos_df <- left_join(m_mos, m_mos_df, by = c("Village", "Date", "Treatment", "WashedStatus", "Mortality",
"Hut", "Sleeper", "marker", "Insecticide", "Week", "Nets",
"Loc.Tot" = "Location"))
m_mos_df <- left_join(m_mos, m_mos_df, by = c("Village", "Date", "Treatment", "WashedStatus", "Mortality",
"Hut", "Sleeper", "marker", "Insecticide", "Week", "Nets",
"Location" ="Loc.Tot"))
View(m_mos_df)
View(m_mos)
View(Tengrela_R1A_rm)
####Plot mortality against the number of mosquitoes to observe the relationship
m_mos_df <- as.tibble(Tengrela_R1A_rm) %>%
gather("Loc", "Total.Loc", c("Total.Room","Total.Net","Total.Ver")) %>%
mutate(Loc.Tot = case_when(Loc == "Total.Room" ~ "Room",
Loc == "Total.Net" ~ "Net",
Loc == "Total.Ver" ~ "Veranda"))%>%
dplyr::select(c("Village", "Date", "Treatment", "WashedStatus", "Mortality", "Loc.Tot", "Total.Loc",
"Hut", "Sleeper", "marker", "Insecticide", "Week", "Nets"))
####Plot mortality against the number of mosquitoes to observe the relationship
m_mos_df <- as.tibble(Tengrela_R1A_rm) %>%
gather("Loc", "Total.Loc", c("Total.Room","Total.Net","Total.Ver")) %>%
mutate(Loc.Tot = case_when(Loc == "Total.Room" ~ "Room",
Loc == "Total.Net" ~ "Net",
Loc == "Total.Ver" ~ "Veranda"))%>%
dplyr::select(c("Village", "Date", "Treatment", "Loc.Tot", "Total.Loc",
"Hut", "Sleeper", "marker"))
m_mos_df <- left_join(m_mos, m_mos_df, by = c("Village", "Date", "Treatment", "Hut", "Sleeper", "marker",
"Location" ="Loc.Tot"))
View(m_mos_df)
ggplot(m_mos_df, aes(x = Total.Loc, y = Mortality, color = Nets, fill = Nets))+
geom_point()+
facet_grid(vars(Location), vars(Treatment))+
labs(title = "Mortality correponding to number of mosquitoes",
x = "Number of mosquitoes")+
scale_y_continuous( breaks = seq(0,1,0.25), limits = c(0,1))+
theme(plot.title = element_text(hjust = 0.5))+
stat_smooth(method = "lm", formula = y~x)
ggsave("Mortality correponding to number of mosquito.jpeg", device = jpeg)
View(Tengrela_R1A_rm)
bf_mos_df <- as.tibble(Tengrela_R1A_rm) %>%
gather("Loc", "Fed.Loc", c("Fed.Room","Fed.Net","Fed.Ver")) %>%
mutate(Loc.Tot = case_when(Loc == "Fed.Room" ~ "Room",
Loc == "Fed.Net" ~ "Net",
Loc == "Fed.Ver" ~ "Veranda"))%>%
dplyr::select(c("Village", "Date", "Treatment", "Loc.Tot", "Fed.Loc",
"Hut", "Sleeper", "marker"))
bf_mos_df <- left_join(bf_mos, bf_mos_df, by = c("Village", "Date", "Treatment", "Hut", "Sleeper", "marker",
"Location" ="Loc.Tot"))
View(bf_mos_df)
bf_mos_df <- as.tibble(Tengrela_R1A_rm) %>%
gather("Loc", "Total.Loc", c("Total.Room","Total.Net","Total.Ver")) %>%
mutate(Loc.Tot = case_when(Loc == "Total.Room" ~ "Room",
Loc == "Total.Net" ~ "Net",
Loc == "Total.Ver" ~ "Veranda"))%>%
dplyr::select(c("Village", "Date", "Treatment", "Loc.Tot", "Total.Loc",
"Hut", "Sleeper", "marker"))
bf_mos_df <- left_join(bf_mos, bf_mos_df, by = c("Village", "Date", "Treatment", "Hut", "Sleeper", "marker",
"Location" ="Loc.Tot"))
View(bf_mos_df)
ggplot(bf_mos_df, aes(x = Total.Loc, y = Bloodfed, color = Nets, fill = Nets))+
geom_point()+
facet_grid(vars(Location), vars(Treatment))+
labs(title = "Blood feeding rate correponding to number of mosquitoes",
x = "Number of mosquitoes", y = "blood feeding rate")+
scale_y_continuous( breaks = seq(0,1,0.25), limits = c(0,1))+
theme(plot.title = element_text(hjust = 0.5))+
stat_smooth(method = "lm", formula = y~x)
ggsave("Blood feeding rate correponding to number of mosquitoe.jpeg", device = jpeg)
ggplot(bf_mos_df, aes(x = Total.Loc, y = Bloodfed, color = Nets, fill = Nets))+
geom_point()+
facet_grid(vars(Location), vars(Insecticide))+
labs(title = "Blood feeding rate correponding to number of mosquitoes",
x = "Number of mosquitoes", y = "blood feeding rate")+
scale_y_continuous( breaks = seq(0,1,0.25), limits = c(0,1))+
theme(plot.title = element_text(hjust = 0.5))+
stat_smooth(method = "lm", formula = y~x)
ggplot(bf_mos_df, aes(x = Total.Loc, y = Bloodfed, color = Location, fill = Location))+
geom_point()+
facet_grid(vars(Location), vars(Insecticide))+
labs(title = "Blood feeding rate correponding to number of mosquitoes",
x = "Number of mosquitoes", y = "blood feeding rate")+
scale_y_continuous( breaks = seq(0,1,0.25), limits = c(0,1))+
theme(plot.title = element_text(hjust = 0.5))+
stat_smooth(method = "lm", formula = y~x)
ggplot(bf_mos_df, aes(x = Total.Loc, y = Bloodfed, color = Nets, fill = Nets))+
geom_point()+
facet_grid(vars(Location), vars(Insecticide))+
labs(title = "Blood feeding rate correponding to number of mosquitoes",
x = "Number of mosquitoes", y = "blood feeding rate")+
scale_y_continuous( breaks = seq(0,1,0.25), limits = c(0,1))+
theme(plot.title = element_text(hjust = 0.5))+
stat_smooth(method = "lm", formula = y~x)
ggsave("Blood feeding rate correponding to number of mosquitoe.jpeg", device = jpeg)
summary(bf_2_3_int_rand)
summary(bf_2_3_obs)
write.csv(tidy(bf_2_3_obs), "Blood feeding best model.csv")
summary(bf_2_2_obs)
#AIC: 3192.5
#Var: 2.178
summary(glmer(Fed~Location +WashedStatus + Insecticide+ (1|marker), data = bf_reg, family =  binomial("logit")))
tidy(bf_2_3_obs)
rbind(tidy(bf_2_3_obs), tidy(bf_2_2_obs))
write.csv(rbind(tidy(bf_2_3_obs),tidy(bf_2_2_obs)), "Blood feeding best model.csv")
bf_reg$WashedStatus <- relevel(as.factor(bf_reg$WashedStatus), ref = "UTN")
bf_2_2_obs <- glmer(Fed~Location +WashedStatus + (1|marker), data = bf_reg, family =  binomial("logit"))
summary(bf_2_2_obs)
write.csv(rbind(tidy(bf_2_3_obs),tidy(bf_2_2_obs)), "Blood feeding best model.csv")
#AIC: 3192.6
#Var: 2.215
bf_reg$Insecticide <- relevel(as.factor(bf_reg$Insecticide), ref = "UTN")
bf_2_3_obs <- glmer(Fed~Location +Insecticide + (1|marker), data = bf_reg, family =  binomial("logit"))
summary(bf_2_3_obs)
#AIC: 3192.6
#AIC: 3192.6
#Var: 2.215
write.csv(rbind(tidy(bf_2_3_obs),tidy(bf_2_2_obs)), "Blood feeding best model.csv")
summary(bf_2_2_obs)
bf_2_1_obs <- glmer(Fed~Location + Treatment + (1|marker), data = bf_reg, family =  binomial("logit"))
bf_2_1_obs <- update(bf_2_1_obs, control = glmerControl(optimizer = "bobyqa"))
summary(bf_2_1_obs)
View(n_mos)
####Basic model without any covariate
model_0 <- glm.nb(formula = Count~1, data = n_mos)
summary(model_0)
summary(model_1_5)
model_2_4 <- glm.nb(formula = Count~Location + Nets, data = n_mos)
summary(model_2_4)
model_3_3 <- glm.nb(formula = Count~Location + Insecticide + Location*Insecticide , data = n_mos)
summary(model_3_3)
model_3_4 <- glm.nb(formula = Count~Location + Nets + Location * Nets, data = n_mos)
summary(model_3_4)
summary(model_4_3)
summary(glmer.nb(formula = Count~Location + WashedStatus + (1|marker)  , data = n_mos))
model_5_1 <- glmer.nb(formula = Count~Location + WashedStatus+ (1|Sleeper), data = n_mos)
model_5_1 <- glmer.nb(formula = Count~Location + WashedStatus+ (1|marker), data = n_mos)
summary(model_5_1)
model_5_2 <- glmer.nb(formula = Count~Location + Treatment + (1|marker), data = n_mos)
summary(model_5_2)
model_5_3 <- glmer.nb(formula = Count~Location + WashedStatus+ Location * WashedStatus+ (1|marker), data = n_mos)
summary(model_5_3)
model_5_4 <- glmer.nb(formula = Count~Location + Treatment + Location* Treatment + (1|marker), data = n_mos)
summary(model_5_4)
model_5_4 <- update(model_5_4, control = glmerControl(optimizer = "bobyqa"))
summary(model_5_4)
model_5_1 <- glmer.nb(formula = Count~Location + (1|marker)+ (1|Sleeper) + (1|Week) , data = n_mos)
summary(model_5_1)
model_5_2 <- glmer.nb(formula = Count~Location + WashedStatus + (1|marker) + (1|Sleeper)  + (1|Week) , data = n_mos)
summary(model_5_2)
model_5_2 < update(model_5_2, control =glmerControl(optimizer = "bobyqa"))
model_5_2 <- update(model_5_2, control = glmerControl(optimizer = "bobyqa"))
ss <- getME(model_5_2,c("theta","fixef"))
model_5_2 <- update(model_5_2,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
model_5_2 <- update(model_5_2,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=3e5)))
model_5_2 <- update(model_5_2,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=4e5)))
model_5_2 <- glmer.nb(formula = Count~Location + WashedStatus + (1|marker) + (1|Sleeper)  + (1|Week) , data = n_mos)
ss <- getME(model_5_2,c("theta","fixef"))
model_5_2 <- update(model_5_2,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=4e5)))
summary(model_5_2)
model_5_3 <- glmer.nb(formula = Count~Treatment + Location + (1|marker) + (1|Sleeper)  + (1|Week) , data = n_mos)
ss <- getME(model_5_3,c("theta","fixef"))
model_5_3 <- update(model_5_3,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=4e5)))
summary(model_5_3)
model_5_4 <- glmer.nb(formula = Count~WashedStatus + Location + WashedStatus * Location
+ (1|marker) +(1|Sleeper) + (1|Week), data = n_mos)
ss <- getME(model_5_4,c("theta","fixef"))
model_5_4 <- update(model_5_4,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=4e5)))
summary(model_5_4)
model_5_5 <- glmer.nb(formula = Count~Location + Treatment + Location*Treatment+
(1|marker)+ (1|Sleeper)  + (1|Week), data = n_mos)
ss <- getME(model_5_5,c("theta","fixef"))
model_5_5 <- update(model_5_5,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=4e5)))
summary(model_5_5)
model_5_1 <- glmer.nb(formula = Count~Location + WashedStatus+ (1|marker), data = n_mos)
summary(model_5_1)
write.csv(tidy(model_5_1), "Number of mosquitoes (Location and Washed status with observational re).csv")
model_6_5 <- glmer.nb(formula = Count~Location + Treatment + Location*Treatment+
(1|marker)+ (1|Sleeper)  + (1|Week), data = n_mos)
ss <- getME(model_6_5,c("theta","fixef"))
model_6_5 <- update(model_6_5,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=4e5)))
summary(model_6_5)
###Export the model fit to a csv file
write.csv(rbind(tidy(model_5_1), tidy(model_6_5)), "Number of mosquitoes (Location and Treatment with interaction).csv")
rbind(tidy(model_5_1), tidy(model_6_5))
summary(model_6_5)
n_mos$WashedStatus <- relevel(as.factor(n_mos$WashedStatus), ref = "UTN")
model_5_1 <- glmer.nb(formula = Count~Location + WashedStatus+ (1|marker), data = n_mos)
summary(model_5_1)
###Export the model fit to a csv file
write.csv(rbind(tidy(model_5_1), tidy(model_6_5)), "Number of mosquitoes (Location and Treatment with interaction).csv")
summary(model_5_1)
summary(model_6_5)
library(lme4)
library(tidyverse)
library(DHARMa)
library(lubridate)
library(MASS)
library(merTools)
library(ggpubr)
library(ggpmisc)
library(fitdistrplus)
library(broom)
summary(glmer(Fed~Location +Insecticide +WashedStatus+ (1|marker),
data = bf_reg, family =  binomial("logit")))
summary(glmer(Fed~Location +Insecticide +WashedStatus+ Insecticide *WashedStatus+  (1|marker),
data = bf_reg, family =  binomial("logit")))
summary(mor_fed_num_ms)
write.csv(tidy(mor_fed_num_ms), "Mortality n blood-fed n number best model.csv")
mor_fed$Treatment <- relevel(as.factor(mor_fed$Treatment), ref="UTN")
mor_fed_num_ms <- glmer(Dead~Fed + Location + Treatment + Location * Treatment + Total.Loc + Total.Loc*Treatment +
(1 | marker)+ (1 | Sleeper), data = mor_fed, family = binomial("logit"))
ss <- getME(mor_fed_num_ms,c("theta","fixef"))
mor_fed_num_ms <- update(mor_fed_num_ms,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=5e5)))
summary(mor_fed_num_ms)
write.csv(tidy(mor_fed_num_ms), "Mortality n blood-fed n number best model.csv")
library(cowplot)
###Plot by Treatment
ggplot(n_mos, aes(x = Date, y = Count))+
geom_col(aes(fill = Location))+
facet_wrap(vars(Treatment), ncol = 2)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1.5),
plot.title = element_text(hjust = 0.5, size = 15))+
labs(title = 'Number of mosquitoes per night by Treatment')+
scale_x_date(date_breaks = "1 week")
ggplot(n_mos, aes(x = Total))+
geom_histogram(aes(fill = Treatment), binwidth = 3, center = 0, alpha = 0.7)+
facet_wrap(vars(Treatment), ncol = 2)+
theme(plot.title = element_text(hjust = 0.5, size = 12),
legend.position = "none")+
labs(title = 'Number of mosquitoes per night by Treatment')+
scale_x_continuous(breaks = seq(0, maxTotal, 10))
